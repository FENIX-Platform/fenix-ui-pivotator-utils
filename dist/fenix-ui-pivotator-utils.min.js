define(["underscore"],function(e){return function(e){function s(i){if(a[i])return a[i].exports;var t=a[i]={exports:{},id:i,loaded:!1};return e[i].call(t.exports,t,t.exports,s),t.loaded=!0,t.exports}var a={};return s.m=e,s.c=a,s.p="",s(0)}([function(e,s,a){e.exports=a(1)},function(e,s,a){var i,t;i=[a(2)],t=function(e){function s(s,a){function t(){var e=[];for(var s in o.dimensions)e.push(s);return e}function n(e,s,a){var i=s.showCode,t=[];for(var n in e)i&&a.dimensions[e[n]].label&&t.push(a.dimensions[e[n]].code),t.push(a.dimensions[e[n]].label||a.dimensions[e[n]].code);return t}var u={};e.extend(u,a);var o=i(s,a);if("fenixtool"==a.inputFormat){var l="EN";a.lang&&(l=a.lang);console.log("initRow",a),u={inputFormat:"fenixTool",aggregationFn:a.aggregationFn||{value:"sum"},aggregations:n(a.aggregations,a,o),hidden:n(a.hidden,a,o),columns:n(a.columns,a,o),values:a.values||"value",groupedRow:a.groupedRow,rows:n(a.rows,a,o),formatter:a.formatter||"value",showRowHeaders:a.showRowHeaders||!1,decimals:a.decimals||2,showCode:a.showCode||!1,showFlag:a.showFlag||!1,showUnit:a.showUnit||!1}}return u.columns.length+u.rows.length==0&&(u.rows=n(t(),a,o)),u}function a(e,s){function a(e,s,a,i){n.dimensions[e]||(n.dimensions[e]={}),n.dimensions[e][s]=a,i&&(n.dimensions[e].subject=i)}function i(e,s,a){n.values[e]||(n.values[e]={}),"attribute"!=s?n.values[e][s]=a:(n.values[e].attributes||(n.values[e].attributes=[]),n.values[e].attributes.push(a))}var t="EN";s&&s.hasOwnProperty("lang")&&(t=s.lang);var n={dimensions:{},values:{}};for(var u in e.columns){var o=e.columns[u];1==o.key?(a(o.id,"title",o.title[t]||o.id),a(o.id,"code",o.id,o.subject)):2==o.id.split("_"+t).length?a(o.id.split("_"+t)[0],"label",o.id):"number"==o.dataType&&"value"==o.subject?(i(o.id,"value",o.id),i(o.id,"label",o.id),i(o.id,"subject",o.subject)):2==o.id.split("|*").length?"um"==o.subject?i(o.id.split("|*")[0],"unit",o.id):"flag"==o.subject?i(o.id.split("|*")[0],"flag",o.id):i(o.id.split("|*")[0],"attributes",o.id):"um"==o.subject?i("value","unit",o.id):"flag"==o.subject?i("value","flag",o.id):i("value","attribute",o.id)}return n}function i(e,s){function a(e,s,a){t[e]||(t[e]={}),"attributes"==s?t[e][s]?t[e][s].push(a):t[e][s]=[a]:t[e][s]=a}var i={dimensions:{},values:{},attributes:{}},t={},n="EN";s&&s.lang&&(n=s.lang);for(var u in e.columns){var o=e.columns[u];1==o.key?(a(o.id,"code",o.id),a(o.id,"title",o.title[n]||o.id),a(o.id,"type","dimension"),o.subject&&a(o.id,"subject",o.subject)):2==o.id.split("_"+n).length?a(o.id.split("_"+n)[0],"label",o.id):"number"==o.dataType&&"value"==o.subject?(a("value","type","value"),a("value","value",o.id),a("value","title","value"),o.subject&&a("value","subject",o.subject)):2==o.id.split("|*").length?"um"==o.subject?a(o.id.split("|*")[0],"unit",o.id):"flag"==o.subject?a(o.id.split("|*")[0],"flag",o.id):a(o.id.split("|*")[0],"attributes",o.id):"um"==o.subject?(a(o.id,"type","attribute"),a(o.id,"value",o.id),a(o.id,"title","unit"),o.subject&&a(o.id,"subject",o.subject),a("value","unit",o.id)):"flag"==o.subject?a("value","flag",o.id):(a(o.id,"type","attribute"),a(o.id,"value",o.id),a(o.id,"title",o.title[n]||o.id),o.subject&&a(o.id,"subject",o.subject))}for(var u in t)"dimension"==t[u].type?i.dimensions[u]=t[u]:"value"==t[u].type?i.values[u]=t[u]:(i.attributes[u]=t[u],"um"==t[u].subject&&(i.values.value.unit=t[u].label||t[u].value));return i}function t(e,s){var a=i(e,s);d=a;var t=[],n=[],u=[],o=[],l=[];for(var r in d.dimensions)"time"==d.dimensions[r].subject?n.push({value:d.dimensions[r].code,label:d.dimensions[r].title}):u.push({value:d.dimensions[r].code,label:d.dimensions[r].title});for(var r in d.values)l.push({value:d.values[r].value,label:d.values[r].title});for(var r in d.attributes)o.push({value:d.attributes[r].value,label:d.attributes[r].title});var v={hidden:t,rows:u,columns:n,aggregations:o,values:l};return v}function n(e,s){}function u(e,s){}function o(s,a){var i=t(s.metadata.dsd),n={rows:"Rows",columns:"Columns",hidden:"Hidden",aggregations:"Aggregation",values:"Values"};a&&(n={rows:a.rowLabel||"Rows",columns:a.columnsLabel||"Columns",hidden:a.hiddenLabel||"Hidden",aggregations:a.aggregationsLabel||"Aggregation",values:a.valuesLabel||"Values"});var u={dimensionsSort:{selector:{id:"sortable",source:[],config:{groups:n}},template:{hideSwitch:!0,hideRemoveButton:!0,title:"Sort dimension"}},aggregatorValue:{selector:{id:"dropdown",source:[{value:"sum",label:"Sum"},{value:"avg",label:"avg"},{value:"median",label:"median"},{value:"stdev",label:"stdev"},{value:"count",label:"count"},{value:"concat",label:"concat"}],config:{maxItems:1},"default":["sum"]},template:{title:"Aggregator for Value"}}},o=e.map(i.aggregations,function(e){return e.parent="aggregations",e}),l=e.map(i.columns,function(e){return e.parent="columns",e}),r=e.map(i.rows,function(e){return e.parent="rows",e}),d=e.map(i.hidden,function(e){return e.parent="hidden",e}),v=e.map(i.values,function(e){return e.parent="values",e});return u.dimensionsSort.selector.source=e.union(o,d,l,r,v),u}function l(e){var s=[],a=[],i=[],t=[],n=[],u=Array.isArray(e.values.typeOfChart)?e.values.typeOfChart[0]:"line",o={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0],VALUE:e.values.aggregatorValue[0]},l={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var r in e.values.show){var v=e.values.show[r];"code"==v?l.showCode=!0:"unit"==v?l.showUnit=!0:"flag"==v&&(l.showFlag=!0)}for(var r in e.values.dimensionsSort){var v=e.values.dimensionsSort[r];"rows"==v.parent?l.series[v.value]=!0:"columns"==v.parent?l.x[v.value]=!0:"values"==v.parent?l.y[v.value]=!0:"hidden"==v.parent}for(var c in e.values.dimensionsSort){var r=e.values.dimensionsSort[c].value;d.dimensions[r]&&l.series[d.dimensions[r].code]&&(i.push(d.dimensions[r].label||d.dimensions[r].code),1==l.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&i.push(d.dimensions[r].code)),d.dimensions[r]&&l.x[d.dimensions[r].code]&&(a.push(d.dimensions[r].label||d.dimensions[r].code),1==l.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&a.push(d.dimensions[r].code))}for(var r in d.values)if(l.y[d.values[r].value]){n.push(d.values[r].value),1==l.showUnit&&d.values[r].unit&&n.push(d.values[r].unit),1==l.showFlag&&d.values[r].flag&&n.push(d.values[r].flag);for(var m in d.values[r].attribute)s.push(d.values[r].attribute[m])}for(var r in d.attributes)l.y[d.attributes[r].value]?n.push(d.attributes[r].value):l.x[d.attributes[r].value]?a.push(d.attributes[r].value):l.series[d.attributes[r].value]&&i.push(d.attributes[r].value);var g={aggregationFn:o,formatter:"value",decimals:2,hidden:s,series:i,x:a,aggregations:t,y:n,type:u};return g}function r(e){var s=[],a=[],i=[],t=[],n=[],u=e.values.format[0],o=!0;e.values.hasOwnProperty("groupedRow")&&(o=e.values.groupedRow.length>0);var l={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0]},r={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var v in e.values.show){var c=e.values.show[v];"code"==c?r.showCode=!0:"unit"==c?r.showUnit=!0:"flag"==c&&(r.showFlag=!0)}for(var v in e.values.dimensionsSort){var c=e.values.dimensionsSort[v];"rows"==c.parent?r.series[c.value]=!0:"columns"==c.parent?r.x[c.value]=!0:"values"==c.parent?r.y[c.value]=!0:"hidden"==c.parent}for(var m in e.values.dimensionsSort){var v=e.values.dimensionsSort[m].value;d.dimensions[v]&&r.series[d.dimensions[v].code]&&(i.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(i.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.x[d.dimensions[v].code]&&(a.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(a.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.y[d.dimensions[v].code]&&n.push(d.dimensions[v].code)}for(var v in d.values)if(r.y[d.values[v].value]){n.push(d.values[v].value),1==r.showUnit&&d.values[v].unit&&n.push(d.values[v].unit),1==r.showFlag&&d.values[v].flag&&n.push(d.values[v].flag);for(var g in d.values[v].attribute)s.push(d.values[v].attribute[g])}for(var v in d.attributes)r.y[d.attributes[v].value]?n.push(d.attributes[v].label||d.attributes[v].value):r.x[d.attributes[v].value]?a.push(d.attributes[v].label||d.attributes[v].value):r.series[d.attributes[v].value]&&i.push(d.attributes[v].label||d.attributes[v].value);var b={groupedRow:o,aggregationFn:l,formatter:u,decimals:e.values.decimals||2,showRowHeaders:!0,hidden:s,rows:i,columns:a,aggregations:t,values:n};return b}var d;return function(){return{convertFX:a,initFXT:t,initFXD:n,initFXDgraph:u,parseInput:s,toFilter:o,toChartConfig:l,toTableConfig:r}}}.apply(s,i),!(void 0!==t&&(e.exports=t))},function(s,a){s.exports=e}])});
//# sourceMappingURL=fenix-ui-pivotator-utils.min.js.map