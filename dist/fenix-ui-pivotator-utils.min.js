define(["underscore"],function(e){return function(e){function s(a){if(i[a])return i[a].exports;var t=i[a]={exports:{},id:a,loaded:!1};return e[a].call(t.exports,t,t.exports,s),t.loaded=!0,t.exports}var i={};return s.m=e,s.c=i,s.p="",s(0)}([function(e,s,i){e.exports=i(1)},function(e,s,i){var a,t;a=[i(2)],t=function(e){function s(e,s){function i(){var e=[];for(var s in u.dimensions)e.push(s);return e}function t(e,s,i){var a=s.showCode,t=[];for(var n in e)a&&i.dimensions[e[n]].label&&t.push(i.dimensions[e[n]].code),t.push(i.dimensions[e[n]].label||i.dimensions[e[n]].code);return t}var n=$.extend(!0,{},s),u=a(e,s);if("fenixtool"==s.inputFormat){var o="EN";s.lang&&(o=s.lang);console.log("initRow",s),n={inputFormat:"fenixTool",aggregationFn:s.aggregationFn||{value:"sum"},aggregations:t(s.aggregations,s,u),hidden:t(s.hidden,s,u),columns:t(s.columns,s,u),values:s.values||"value",groupedRow:s.groupedRow,rows:t(s.rows,s,u),formatter:s.formatter||"value",showRowHeaders:s.showRowHeaders||!1,decimals:s.decimals||2,showCode:s.showCode||!1,showFlag:s.showFlag||!1,showUnit:s.showUnit||!1}}return n.columns.length+n.rows.length==0&&(n.rows=t(i(),s,u)),n}function i(e,s){function i(e,s,i,a){n.dimensions[e]||(n.dimensions[e]={}),n.dimensions[e][s]=i,a&&(n.dimensions[e].subject=a)}function a(e,s,i){n.values[e]||(n.values[e]={}),"attribute"!=s?n.values[e][s]=i:(n.values[e].attributes||(n.values[e].attributes=[]),n.values[e].attributes.push(i))}var t="EN";s&&s.hasOwnProperty("lang")&&(t=s.lang);var n={dimensions:{},values:{}};for(var u in e.columns){var o=e.columns[u];1==o.key?(i(o.id,"title",o.title[t]||o.id),i(o.id,"code",o.id,o.subject)):2==o.id.split("_"+t).length?i(o.id.split("_"+t)[0],"label",o.id):"number"==o.dataType&&"value"==o.subject?(a(o.id,"value",o.id),a(o.id,"label",o.id),a(o.id,"subject",o.subject)):2==o.id.split("|*").length?"um"==o.subject?a(o.id.split("|*")[0],"unit",o.id):"flag"==o.subject?a(o.id.split("|*")[0],"flag",o.id):a(o.id.split("|*")[0],"attributes",o.id):"um"==o.subject?a("value","unit",o.id):"flag"==o.subject?a("value","flag",o.id):a("value","attribute",o.id)}return n}function a(e,s){function i(e,s,i){t[e]||(t[e]={}),"attributes"==s?t[e][s]?t[e][s].push(i):t[e][s]=[i]:t[e][s]=i}var a={dimensions:{},values:{},attributes:{}},t={},n="EN";s&&s.lang&&(n=s.lang);for(var u in e.columns){var o=e.columns[u];1==o.key?(i(o.id,"code",o.id),i(o.id,"title",o.title[n]||o.id),i(o.id,"type","dimension"),o.subject&&i(o.id,"subject",o.subject)):2==o.id.split("_"+n).length?i(o.id.split("_"+n)[0],"label",o.id):"number"==o.dataType&&"value"==o.subject?(i("value","type","value"),i("value","value",o.id),i("value","title","value"),o.subject&&i("value","subject",o.subject)):2==o.id.split("|*").length?"um"==o.subject?i(o.id.split("|*")[0],"unit",o.id):"flag"==o.subject?i(o.id.split("|*")[0],"flag",o.id):i(o.id.split("|*")[0],"attributes",o.id):"um"==o.subject?(i(o.id,"type","attribute"),i(o.id,"value",o.id),i(o.id,"title","unit"),o.subject&&i(o.id,"subject",o.subject),i("value","unit",o.id)):"flag"==o.subject?i("value","flag",o.id):(i(o.id,"type","attribute"),i(o.id,"value",o.id),i(o.id,"title",o.title[n]||o.id),o.subject&&i(o.id,"subject",o.subject))}for(var u in t)"dimension"==t[u].type?a.dimensions[u]=t[u]:"value"==t[u].type?a.values[u]=t[u]:(a.attributes[u]=t[u],"um"==t[u].subject&&(a.values.value.unit=t[u].label||t[u].value));return a}function t(e,s){var i=a(e,s);d=i;var t=[],n=[],u=[],o=[],l=[];for(var r in d.dimensions)"time"==d.dimensions[r].subject?n.push({value:d.dimensions[r].code,label:d.dimensions[r].title}):u.push({value:d.dimensions[r].code,label:d.dimensions[r].title});for(var r in d.values)l.push({value:d.values[r].value,label:d.values[r].title});for(var r in d.attributes)o.push({value:d.attributes[r].value,label:d.attributes[r].title});var v={hidden:t,rows:u,columns:n,aggregations:o,values:l};return v}function n(e,s){}function u(e,s){}function o(s,i){var a=t(s.metadata.dsd),n={rows:"Rows",columns:"Columns",hidden:"Hidden",aggregations:"Aggregation",values:"Values"};i&&(n={rows:i.rowLabel||"Rows",columns:i.columnsLabel||"Columns",hidden:i.hiddenLabel||"Hidden",aggregations:i.aggregationsLabel||"Aggregation",values:i.valuesLabel||"Values"});var u={dimensionsSort:{selector:{id:"sortable",source:[],config:{groups:n}},template:{hideSwitch:!0,hideRemoveButton:!0,title:"Sort dimension"}},aggregatorValue:{selector:{id:"dropdown",source:[{value:"sum",label:"Sum"},{value:"avg",label:"avg"},{value:"median",label:"median"},{value:"stdev",label:"stdev"},{value:"count",label:"count"},{value:"concat",label:"concat"}],config:{maxItems:1},"default":["sum"]},template:{title:"Aggregator for Value"}}},o=e.map(a.aggregations,function(e){return e.parent="aggregations",e}),l=e.map(a.columns,function(e){return e.parent="columns",e}),r=e.map(a.rows,function(e){return e.parent="rows",e}),d=e.map(a.hidden,function(e){return e.parent="hidden",e}),v=e.map(a.values,function(e){return e.parent="values",e});return u.dimensionsSort.selector.source=e.union(o,d,l,r,v),u}function l(e){var s=[],i=[],a=[],t=[],n=[],u=Array.isArray(e.values.typeOfChart)?e.values.typeOfChart[0]:"line",o={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0],VALUE:e.values.aggregatorValue[0]},l={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var r in e.values.show){var v=e.values.show[r];"code"==v?l.showCode=!0:"unit"==v?l.showUnit=!0:"flag"==v&&(l.showFlag=!0)}for(var r in e.values.dimensionsSort){var v=e.values.dimensionsSort[r];"rows"==v.parent?l.series[v.value]=!0:"columns"==v.parent?l.x[v.value]=!0:"values"==v.parent?l.y[v.value]=!0:"hidden"==v.parent}for(var c in e.values.dimensionsSort){var r=e.values.dimensionsSort[c].value;d.dimensions[r]&&l.series[d.dimensions[r].code]&&(a.push(d.dimensions[r].label||d.dimensions[r].code),1==l.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&a.push(d.dimensions[r].code)),d.dimensions[r]&&l.x[d.dimensions[r].code]&&(i.push(d.dimensions[r].label||d.dimensions[r].code),1==l.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&i.push(d.dimensions[r].code))}for(var r in d.values)if(l.y[d.values[r].value]){n.push(d.values[r].value),1==l.showUnit&&d.values[r].unit&&n.push(d.values[r].unit),1==l.showFlag&&d.values[r].flag&&n.push(d.values[r].flag);for(var m in d.values[r].attribute)s.push(d.values[r].attribute[m])}for(var r in d.attributes)l.y[d.attributes[r].value]?n.push(d.attributes[r].value):l.x[d.attributes[r].value]?i.push(d.attributes[r].value):l.series[d.attributes[r].value]&&a.push(d.attributes[r].value);var g={aggregationFn:o,formatter:"value",decimals:2,hidden:s,series:a,x:i,aggregations:t,y:n,type:u};return g}function r(e){var s=[],i=[],a=[],t=[],n=[],u=e.values.format[0],o=!0;e.values.hasOwnProperty("groupedRow")&&(o=e.values.groupedRow.length>0);var l={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0]},r={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var v in e.values.show){var c=e.values.show[v];"code"==c?r.showCode=!0:"unit"==c?r.showUnit=!0:"flag"==c&&(r.showFlag=!0)}for(var v in e.values.dimensionsSort){var c=e.values.dimensionsSort[v];"rows"==c.parent?r.series[c.value]=!0:"columns"==c.parent?r.x[c.value]=!0:"values"==c.parent?r.y[c.value]=!0:"hidden"==c.parent}for(var m in e.values.dimensionsSort){var v=e.values.dimensionsSort[m].value;d.dimensions[v]&&r.series[d.dimensions[v].code]&&(a.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(a.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.x[d.dimensions[v].code]&&(i.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(i.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.y[d.dimensions[v].code]&&n.push(d.dimensions[v].code)}for(var v in d.values)if(r.y[d.values[v].value]){n.push(d.values[v].value),1==r.showUnit&&d.values[v].unit&&n.push(d.values[v].unit),1==r.showFlag&&d.values[v].flag&&n.push(d.values[v].flag);for(var g in d.values[v].attribute)s.push(d.values[v].attribute[g])}for(var v in d.attributes)r.y[d.attributes[v].value]?n.push(d.attributes[v].label||d.attributes[v].value):r.x[d.attributes[v].value]?i.push(d.attributes[v].label||d.attributes[v].value):r.series[d.attributes[v].value]&&a.push(d.attributes[v].label||d.attributes[v].value);var b={groupedRow:o,aggregationFn:l,formatter:u,decimals:e.values.decimals||2,showRowHeaders:!0,hidden:s,rows:a,columns:i,aggregations:t,values:n};return b}var d;return function(){return{convertFX:i,initFXT:t,initFXD:n,initFXDgraph:u,parseInput:s,toFilter:o,toChartConfig:l,toTableConfig:r}}}.apply(s,a),!(void 0!==t&&(e.exports=t))},function(s,i){s.exports=e}])});
//# sourceMappingURL=fenix-ui-pivotator-utils.min.js.map