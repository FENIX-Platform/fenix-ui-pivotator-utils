define(["underscore"],function(e){return function(e){function s(i){if(a[i])return a[i].exports;var n=a[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}var a={};return s.m=e,s.c=a,s.p="",s(0)}([function(e,s,a){e.exports=a(1)},function(e,s,a){var i,n;i=[a(2)],n=function(e){function s(s,a){function n(){var e=[];for(var s in l.dimensions)e.push(s);return e}function t(e,s,a){var i=s.showCode,n=[];for(var t in e)i&&a.dimensions[e[t]].label&&n.push(a.dimensions[e[t]].code),n.push(a.dimensions[e[t]].label||a.dimensions[e[t]].code);return n}var u={};e.extend(u,a);var l=i(s,a);if("fenixtool"==a.inputFormat){var o="EN";a.lang&&(o=a.lang);console.log("initRow",a),u={inputFormat:"fenixTool",aggregationFn:a.aggregationFn||{value:"sum"},aggregations:t(a.aggregations,a,l),hidden:t(a.hidden,a,l),columns:t(a.columns,a,l),values:a.values||"value",groupedRow:a.groupedRow,rows:t(a.rows,a,l),formatter:a.formatter||"value",showRowHeaders:a.showRowHeaders||!1,decimals:a.decimals||2,showCode:a.showCode||!1,showFlag:a.showFlag||!1,showUnit:a.showUnit||!1}}return u.columns.length+u.rows.length==0&&(u.rows=t(n(),a,l)),u}function a(e,s){function a(e,s,a,i){t.dimensions[e]||(t.dimensions[e]={}),t.dimensions[e][s]=a,i&&(t.dimensions[e].subject=i)}function i(e,s,a){t.values[e]||(t.values[e]={}),"attribute"!=s?t.values[e][s]=a:(t.values[e].attributes||(t.values[e].attributes=[]),t.values[e].attributes.push(a))}var n="EN";s&&s.hasOwnProperty("lang")&&(n=s.lang);var t={dimensions:{},values:{}};for(var u in e.columns){var l=e.columns[u];1==l.key?(a(l.id,"title",l.title[n]||l.id),a(l.id,"code",l.id,l.subject)):2==l.id.split("_"+n).length?a(l.id.split("_"+n)[0],"label",l.id):"number"==l.dataType&&"value"==l.subject?(i(l.id,"value",l.id),i(l.id,"label",l.id),i(l.id,"subject",l.subject)):2==l.id.split("|*").length?"um"==l.subject?i(l.id.split("|*")[0],"unit",l.id):"flag"==l.subject?i(l.id.split("|*")[0],"flag",l.id):i(l.id.split("|*")[0],"attributes",l.id):"um"==l.subject?i("value","unit",l.id):"flag"==l.subject?i("value","flag",l.id):i("value","attribute",l.id)}return t}function i(e,s){function a(e,s,a){n[e]||(n[e]={}),"attributes"==s?n[e][s]?n[e][s].push(a):n[e][s]=[a]:n[e][s]=a}var i={dimensions:{},values:{},attributes:{}},n={},t="EN";s&&s.lang&&(t=s.lang);for(var u in e.columns){var l=e.columns[u];1==l.key?(a(l.id,"code",l.id),a(l.id,"title",l.title[t]||l.id),a(l.id,"type","dimension"),l.subject&&a(l.id,"subject",l.subject)):2==l.id.split("_"+t).length?a(l.id.split("_"+t)[0],"label",l.id):"number"==l.dataType&&"value"==l.subject?(a("value","type","value"),a("value","value",l.id),a("value","title","value"),l.subject&&a("value","subject",l.subject)):2==l.id.split("|*").length?"um"==l.subject?a(l.id.split("|*")[0],"unit",l.id):"flag"==l.subject?a(l.id.split("|*")[0],"flag",l.id):a(l.id.split("|*")[0],"attributes",l.id):"um"==l.subject?(a(l.id,"type","attribute"),a(l.id,"value",l.id),a(l.id,"title","unit"),l.subject&&a(l.id,"subject",l.subject),a("value","unit",l.id)):"flag"==l.subject?a("value","flag",l.id):(a(l.id,"type","attribute"),a(l.id,"value",l.id),a(l.id,"title",l.title[t]||l.id),l.subject&&a(l.id,"subject",l.subject))}for(var u in n)"dimension"==n[u].type?i.dimensions[u]=n[u]:"value"==n[u].type?i.values[u]=n[u]:(i.attributes[u]=n[u],"um"==n[u].subject&&(console.log("strucInter",i,n),null!=i.values.value&&"undefined"!=typeof i.values.value?(console.log("IF!!!!"),i.values.value.unit=n[u].label||n[u].value):(console.log("ELSE!!!!"),i.values.value={},i.values.value.unit=n[u].label||n[u].value)));return i}function n(e,s){var a=i(e,s);d=a;var n=[],t=[],u=[],l=[],o=[];for(var r in d.dimensions)"time"==d.dimensions[r].subject?t.push({value:d.dimensions[r].code,label:d.dimensions[r].title}):u.push({value:d.dimensions[r].code,label:d.dimensions[r].title});for(var r in d.values)o.push({value:d.values[r].value,label:d.values[r].title});for(var r in d.attributes)l.push({value:d.attributes[r].value,label:d.attributes[r].title});var v={hidden:n,rows:u,columns:t,aggregations:l,values:o};return v}function t(e,s){}function u(e,s){}function l(s,a){console.log("In toFilter!!!");var i=n(s.metadata.dsd),t={rows:"Rows",columns:"Columns",hidden:"Hidden",aggregations:"Aggregation",values:"Values"};a&&(t={rows:a.rowLabel||"Rows",columns:a.columnsLabel||"Columns",hidden:a.hiddenLabel||"Hidden",aggregations:a.aggregationsLabel||"Aggregation",values:a.valuesLabel||"Values"});var u={dimensionsSort:{selector:{id:"sortable",source:[],config:{groups:t}},template:{hideSwitch:!0,hideRemoveButton:!0,title:"Sort dimension"}},aggregatorValue:{selector:{id:"dropdown",source:[{value:"sum",label:"Sum"},{value:"avg",label:"avg"},{value:"median",label:"median"},{value:"stdev",label:"stdev"},{value:"count",label:"count"},{value:"concat",label:"concat"}],config:{maxItems:1},"default":["sum"]},template:{title:"Aggregator for Value"}}},l=e.map(i.aggregations,function(e){return e.parent="aggregations",e}),o=e.map(i.columns,function(e){return e.parent="columns",e}),r=e.map(i.rows,function(e){return e.parent="rows",e}),d=e.map(i.hidden,function(e){return e.parent="hidden",e}),v=e.map(i.values,function(e){return e.parent="values",e});return u.dimensionsSort.selector.source=e.union(l,d,o,r,v),u}function o(e){var s=[],a=[],i=[],n=[],t=[],u=Array.isArray(e.values.typeOfChart)?e.values.typeOfChart[0]:"line",l={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0],VALUE:e.values.aggregatorValue[0]},o={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var r in e.values.show){var v=e.values.show[r];"code"==v?o.showCode=!0:"unit"==v?o.showUnit=!0:"flag"==v&&(o.showFlag=!0)}for(var r in e.values.dimensionsSort){var v=e.values.dimensionsSort[r];"rows"==v.parent?o.series[v.value]=!0:"columns"==v.parent?o.x[v.value]=!0:"values"==v.parent?o.y[v.value]=!0:"hidden"==v.parent}for(var c in e.values.dimensionsSort){var r=e.values.dimensionsSort[c].value;d.dimensions[r]&&o.series[d.dimensions[r].code]&&(i.push(d.dimensions[r].label||d.dimensions[r].code),1==o.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&i.push(d.dimensions[r].code)),d.dimensions[r]&&o.x[d.dimensions[r].code]&&(a.push(d.dimensions[r].label||d.dimensions[r].code),1==o.showCode&&d.dimensions[r].label!=d.dimensions[r].code&&null!=d.dimensions[r].label&&a.push(d.dimensions[r].code))}for(var r in d.values)if(o.y[d.values[r].value]){t.push(d.values[r].value),1==o.showUnit&&d.values[r].unit&&t.push(d.values[r].unit),1==o.showFlag&&d.values[r].flag&&t.push(d.values[r].flag);for(var m in d.values[r].attribute)s.push(d.values[r].attribute[m])}for(var r in d.attributes)o.y[d.attributes[r].value]?t.push(d.attributes[r].value):o.x[d.attributes[r].value]?a.push(d.attributes[r].value):o.series[d.attributes[r].value]&&i.push(d.attributes[r].value);var g={aggregationFn:l,formatter:"value",decimals:2,hidden:s,series:i,x:a,aggregations:n,y:t,type:u};return g}function r(e){var s=[],a=[],i=[],n=[],t=[],u=e.values.format[0],l=!0;e.values.hasOwnProperty("groupedRow")&&(l=e.values.groupedRow.length>0);var o={value:e.values.aggregatorValue[0],Value:e.values.aggregatorValue[0]},r={x:{},y:{},series:{},showUnit:!1,showCode:!1,showFlag:!1};for(var v in e.values.show){var c=e.values.show[v];"code"==c?r.showCode=!0:"unit"==c?r.showUnit=!0:"flag"==c&&(r.showFlag=!0)}for(var v in e.values.dimensionsSort){var c=e.values.dimensionsSort[v];"rows"==c.parent?r.series[c.value]=!0:"columns"==c.parent?r.x[c.value]=!0:"values"==c.parent?r.y[c.value]=!0:"hidden"==c.parent}for(var m in e.values.dimensionsSort){var v=e.values.dimensionsSort[m].value;d.dimensions[v]&&r.series[d.dimensions[v].code]&&(i.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(i.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.x[d.dimensions[v].code]&&(a.push(d.dimensions[v].label||d.dimensions[v].code),d.dimensions[v].label!=d.dimensions[v].code&&null!=d.dimensions[v].label&&(a.push(d.dimensions[v].code),0==r.showCode&&s.push(d.dimensions[v].code))),d.dimensions[v]&&r.y[d.dimensions[v].code]&&t.push(d.dimensions[v].code)}for(var v in d.values)if(r.y[d.values[v].value]){t.push(d.values[v].value),1==r.showUnit&&d.values[v].unit&&t.push(d.values[v].unit),1==r.showFlag&&d.values[v].flag&&t.push(d.values[v].flag);for(var g in d.values[v].attribute)s.push(d.values[v].attribute[g])}for(var v in d.attributes)r.y[d.attributes[v].value]?t.push(d.attributes[v].label||d.attributes[v].value):r.x[d.attributes[v].value]?a.push(d.attributes[v].label||d.attributes[v].value):r.series[d.attributes[v].value]&&i.push(d.attributes[v].label||d.attributes[v].value);var b={groupedRow:l,aggregationFn:o,formatter:u,decimals:e.values.decimals||2,showRowHeaders:!0,hidden:s,rows:i,columns:a,aggregations:n,values:t};return b}var d;return function(){return{convertFX:a,initFXT:n,initFXD:t,initFXDgraph:u,parseInput:s,toFilter:l,toChartConfig:o,toTableConfig:r}}}.apply(s,i),!(void 0!==n&&(e.exports=n))},function(s,a){s.exports=e}])});
//# sourceMappingURL=fenix-ui-pivotator-utils.min.js.map